{% extends 'default.html' %}
{% load censor_filters %}

{% block title %}{{ article.title }} - News Portal{% endblock %}

{% block content %}
<div style="max-width: 1200px; margin: 0 auto;">
    <article class="article-detail">
        <h1>{{ article.title|censor }}</h1>

        <div class="article-meta" style="color: #666; margin-bottom: 20px;">
            <p><strong>–ê–≤—Ç–æ—Ä:</strong> {{ article.author.user.username }}</p>
            <p><strong>–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:</strong> {{ article.created_at|date:"d.m.Y H:i" }}</p>
            <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> {{ article.category.name }}</p>
            <p><strong>–†–µ–π—Ç–∏–Ω–≥:</strong> {{ article.rating }}</p>
        </div>

        <div class="article-content" style="line-height: 1.6; font-size: 16px;">
            {{ article.content|linebreaks|censor }}
        </div>

        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏—è –∏ –ø–æ–¥–ø–∏—Å–∫–∞ -->
        {% if article.category %}
        <div class="categories" style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 8px;">
            <strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong>
            <span class="badge" style="background: #6c757d; color: white; padding: 5px 10px; border-radius: 4px; margin: 2px; display: inline-block;">
                {{ article.category.name }}
                {% if user.is_authenticated %}
                    {% if user in article.category.subscribers.all %}
                        <a href="{% url 'unsubscribe_from_category' article.category.id %}"
                           style="color: white; margin-left: 5px; text-decoration: none;"
                           title="–û—Ç–ø–∏—Å–∞—Ç—å—Å—è –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ {{ article.category.name }}">
                            ‚úï
                        </a>
                    {% else %}
                        <a href="{% url 'subscribe_to_category' article.category.id %}"
                           style="color: white; margin-left: 5px; text-decoration: none;"
                           title="–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—é {{ article.category.name }}">
                            +
                        </a>
                    {% endif %}
                {% endif %}
            </span>
        </div>
        {% endif %}
    </article>

    <!-- –î–µ–π—Å—Ç–≤–∏—è -->
    {% if user.is_authenticated and user == article.author.user or user.is_superuser %}
    <div class="actions" style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee;">
        <a href="{% url 'article_update' article.pk %}" class="btn btn-primary">
            ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—å—é
            {% if user.is_superuser and article.author.user != user %}
                (–∞–¥–º–∏–Ω)
            {% endif %}
        </a>
        <a href="{% url 'article_delete' article.pk %}" class="btn btn-danger">
            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—å—é
            {% if user.is_superuser and article.author.user != user %}
                (–∞–¥–º–∏–Ω)
            {% endif %}
        </a>
    </div>
    {% endif %}
</div>

<style>
.btn {
    display: inline-block;
    padding: 10px 20px;
    margin: 5px;
    text-decoration: none;
    border-radius: 4px;
    border: none;
    cursor: pointer;
}

.btn-primary {
    background: #007bff;
    color: white;
}

.btn-danger {
    background: #dc3545;
    color: white;
}

.article-detail {
    background: white;
    padding: 30px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
</style>
{% endblock %}